---
title: "240302 Aerobic recapitualtion of SIgA-driven stationary cell death of TT8"
author: "Morgan"
date: "`r format(Sys.time(), '%a, %b %d, %Y')`"
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
---

# Setup

## Libraries

```{r}
library(dplyr)
library(ggplot2)
library(magrittr)
library(readr)
library(tidyr)
library(readxl)
```

## Parameters

```{r}
# Source locations
src_dir <- paste0("~/Documents/Stanford/Huang_lab_rotation/SIgA_cell_physiology/",
                  "240302_aerobic_TT8_SIgA_recapitulate")

raw_file <- "240228_TT8_SIgA_aerobic_recapitulation_raw.xlsx"

# Destination locations
dst_dir <- "outputs"

```

------------------------------------------------------------------------

# Computation

## File transformation

```{r}
# Read all csv files
gc_ <- read_excel(file.path(src_dir, raw_file))

# Convert all numerical values to doubles and save as a copy of the raw import
gc <- gc_ %>%
  as.data.frame(lapply(gc_, as.double))

# Preview table
head(gc)

```

------------------------------------------------------------------------

## Raw data manipulation

```{r}
# Generate table of relevant values only
relevant_gc <- gc %>%
  select(Time, D2:D11, E4:E9) %>%
  mutate("0ugmL_SIgA" = rowMeans(select(., D3:D6))) %>%
  mutate("30ugmL_SIgA" = rowMeans(select(., D7:D10))) %>%
  mutate("300ugmL_SIgA" = rowMeans(select(., E5:E8))) %>%
  mutate(blank = rowMeans(select(., D2, D11, E4, E9)))

# Blank all values
for (col_name in names(relevant_gc)) {
  relevant_gc[[col_name]] <- relevant_gc[[col_name]] - relevant_gc$blank
}

# Calculate SD values for each class
"0ugmL_SD" <- apply(gc[, c("D3", "D4", "D5", "D6")], 1, sd)
"30ugmL_SD" <- apply(gc[, c("D7", "D8", "D9", "D10")], 1, sd)
"300ugmL_SD" <- apply(gc[, c("D3", "D4", "D5", "D6")], 1, sd)


# Clean up final table
stat_gc <- subset(relevant_gc, select = -c(D2:E9)) 

```

------------------------------------------------------------------------

## Chart 1

```{r}

```

------------------------------------------------------------------------

# Dependencies

```{r}
# Clean up project of libraries not in use
renv::clean()

# Update lock file with new packages
renv::snapshot()
```

------------------------------------------------------------------------

# Documentation

## Session info

```{r}
print(sessionInfo(), locale = FALSE)
```

## References

```{r}
(.packages()) %>%
  sort() %>%
  lapply(citation) %>%
  lapply(c) %>%
  unique()
```
